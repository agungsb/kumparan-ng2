{"version":3,"file":"kumparan-ng2-component-2.js","sourceRoot":"","sources":["kumparan-ng2-component-2.ts"],"names":[],"mappings":"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","sourcesContent":["import {Component, OnInit} from '@angular/core';\r\n// import { MdButton } from '@angular2-material/button';\r\nimport {MATERIAL_DIRECTIVES, MATERIAL_PROVIDERS, ITableSelectionChange} from 'ng2-material';\r\nimport {MD_TOOLBAR_DIRECTIVES} from '@angular2-material/toolbar';\r\nimport {MdCheckbox} from '@angular2-material/checkbox';\r\nimport {MdInput} from '@angular2-material/input';\r\nimport {employees} from './employees';\r\nimport {fotosrc} from './fotosrc';\r\n\r\n@Component({\r\n  moduleId: module.id,\r\n  selector: 'kumparan-ng2-app',\r\n  templateUrl: 'kumparan-ng2.component.html',\r\n  directives: [MATERIAL_DIRECTIVES, MD_TOOLBAR_DIRECTIVES, MdCheckbox, MdInput],\r\n  providers: [MATERIAL_PROVIDERS],\r\n  styleUrls: ['kumparan-ng2.component.css']\r\n})\r\nexport class KumparanNg2AppComponent implements OnInit {\r\n  fotosrc: string = fotosrc;\r\n  selected: Array<any> = [];\r\n  selection: string;\r\n  count: number;\r\n  foundIndex: Array<any> = [];\r\n  keyword: String = \"\";\r\n  searchResult: String;\r\n\r\n  id: number;\r\n  nama: string;\r\n  ssn: string;\r\n  email: string;\r\n\r\n  request: any;\r\n  employeesData: Array<any> = [];\r\n  db: any;\r\n  dbName: string = \"company_db\";\r\n  objectStoreName: string = \"employees\";\r\n  constructor() { }\r\n  ngOnInit() {\r\n    this.init();\r\n  }\r\n  init() {\r\n    var _self = this;\r\n    this.request = indexedDB.open(this.dbName, 1);\r\n    this.request.onerror = function (event) {\r\n      // Handle errors.\r\n    };\r\n    this.request.onsuccess = function (event: any) {\r\n      _self.db = event.currentTarget.result;\r\n      console.log(_self.db);\r\n      console.log(\"DB Opened!\");\r\n      _self.readAllRecords();\r\n    };\r\n\r\n    this.request.onupgradeneeded = function (event: any) {\r\n      _self.db = event.target.result;\r\n      console.log(event);\r\n      var objectStore;\r\n      console.log(event.target.transaction);\r\n      if (event.oldVersion > 0 && event.newVersion > event.oldVersion) {\r\n        _self.db.deleteObjectStore(_self.objectStoreName);\r\n      }\r\n      // Create an objectStore to hold information about our employees. We're\r\n      // going to use \"ssn\" as our key path because it's guaranteed to be\r\n      // unique - or at least that's what I was told during the kickoff meeting.\r\n      objectStore = _self.db.createObjectStore(_self.objectStoreName, { keyPath: \"id\", autoIncrement: true });\r\n\r\n      // Create an index to search employees by name. We may have duplicates\r\n      // so we can't use a unique index.\r\n      objectStore.createIndex(\"ssn\", \"ssn\", { unique: true });\r\n\r\n      // Create an index to search employees by name. We may have duplicates\r\n      // so we can't use a unique index.\r\n      objectStore.createIndex(\"nama\", \"nama\", { unique: false });\r\n\r\n      // Create an index to search employees by email. We want to ensure that\r\n      // no two employees have the same email, so use a unique index.\r\n      objectStore.createIndex(\"email\", \"email\", { unique: true });\r\n\r\n      // Create an index to display employees' image. We may have duplicates\r\n      // so we can't use a unique index.\r\n      objectStore.createIndex(\"foto\", \"foto\", { unique: false });\r\n\r\n      // Use transaction oncomplete to make sure the objectStore creation is \r\n      // finished before adding data into it.\r\n      objectStore.transaction.oncomplete = function (event) {\r\n        // console.log(event.target.result);\r\n        // // Store values in the newly created objectStore.\r\n      };\r\n    };\r\n  }\r\n  readAllRecords() {\r\n    var _self = this;\r\n    var transaction = this.db.transaction([this.objectStoreName], \"readwrite\");\r\n    var objectStore = transaction.objectStore(this.objectStoreName);\r\n    objectStore.openCursor().onsuccess = function (event) {\r\n      console.log(event);\r\n      var cursor = event.target.result;\r\n      if (cursor) {\r\n        console.log(cursor.key);\r\n        _self.employeesData.push({ \"id\": cursor.key, \"ssn\": cursor.value.ssn, \"nama\": cursor.value.nama, \"email\": cursor.value.email, \"foto\": cursor.value.foto });\r\n        cursor.continue();\r\n      }\r\n    }\r\n  }\r\n  addRecord() {\r\n    var _self = this;\r\n    var transaction = this.db.transaction([this.objectStoreName], \"readwrite\");\r\n    transaction.oncomplete = function (event) {\r\n      // console.log(event);\r\n    }\r\n\r\n    transaction.onerror = function (event) {\r\n      // console.log(event);\r\n      alert(event.target.error.message);\r\n    }\r\n\r\n    var lastId: number = 0;\r\n    if (this.employeesData.length > 0) {\r\n      lastId = this.employeesData[this.employeesData.length - 1].id;\r\n    }\r\n    const nextId = lastId + 1;\r\n    var objectStore = transaction.objectStore(this.objectStoreName);\r\n    var employee = {\r\n      \"id\": nextId,\r\n      \"ssn\": _self.ssn,\r\n      \"nama\": _self.nama,\r\n      \"email\": _self.email,\r\n      \"foto\": _self.fotosrc\r\n    };\r\n    console.log(employee);\r\n    var request = objectStore.add(employee);\r\n    request.onsuccess = function (event) {\r\n      _self.employeesData.push(employee);\r\n    }\r\n  }\r\n  deleteRecord() {\r\n    var _self = this;\r\n    this.selected.sort(function (a, b) {\r\n      return b - a;\r\n    });\r\n    this.selected.forEach((sel: any) => {\r\n      //   console.log(pas[i]);\r\n      var transaction = this.db.transaction([this.objectStoreName], \"readwrite\");\r\n      transaction.oncomplete = function (event) {\r\n        // console.log(event);\r\n        // alert('All is done');\r\n      }\r\n      transaction.onerror = function (event) {\r\n        //   console.log(event);\r\n        alert(\"Telah terjadi kesalahan\");\r\n      }\r\n      var objectStore = transaction.objectStore(this.objectStoreName);\r\n      var request = objectStore.delete(sel);\r\n      request.onsuccess = function (event) {\r\n        //   console.log(event);\r\n        var loc = this.employeesData.map(function (d) { return d['id']; }).indexOf(sel);\r\n        this.employeesData.splice(loc, 1);\r\n      };\r\n    });\r\n    this.selected = [];\r\n    this.keyword = \"\";\r\n  }\r\n  change(data: ITableSelectionChange) {\r\n    this.selected = [];\r\n    this.employeesData.forEach((mat: any) => {\r\n      if (data.values.indexOf(mat.id) !== -1) {\r\n        this.selected.push(mat.id);\r\n      }\r\n    });\r\n    this.selection = this.selected.join(', ');\r\n    this.count = this.selected.length;\r\n  }\r\n  search(event) {\r\n    event.stopPropagation();\r\n    this.keyword = event.target.value;\r\n    this.searchResult = 'hide';\r\n    this.foundIndex = [];\r\n    if (this.keyword.length > 0) {\r\n      var x = this.filterData(event.target.value);\r\n      for (var i in x) {\r\n        var loc = this.employeesData.map(function (d) { return d['id']; }).indexOf(x[i].id);\r\n        this.foundIndex.push(loc);\r\n      }\r\n    } else {\r\n      this.foundIndex = [];\r\n    }\r\n  }\r\n  filterData(keyword) {\r\n    var regex = new RegExp(keyword, 'i');\r\n    const filtered = this.employeesData.filter(function (obj) {\r\n      return obj.nama.search(regex) > -1;\r\n    });\r\n    return filtered;\r\n  }\r\n  isMatched(i) {\r\n    var result = false;\r\n    if (this.keyword.length > 0) {\r\n      result = this.foundIndex.indexOf(i) > -1;\r\n    } else {\r\n      result = true;\r\n    }\r\n    return result;\r\n  }\r\n}\r\n"]}